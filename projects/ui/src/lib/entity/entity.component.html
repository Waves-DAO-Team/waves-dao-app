<div class="container">
  <div class="container__left">
    <button class="container__left__back-btn" [routerLink]="['/']">
      <img src="assets/icons/arr-left.svg">Back
    </button>
  </div>
  <div class="entity">
    <!-- unauthorized --------------------------------------------------------------------------------------------------->
    <div class="card" *ngIf="(userService.data | async)?.userRole == userRoleEnum.unauthorized">
      <ui-header
        [status]="grant?.status?.value || 'no_status'"
        [title]="grant?.title?.value"
        [reward]="grant?.reward?.value"
      ></ui-header>
      <ui-body
        [md]="linkContentService.mdText$.getValue()"
        [link]="grant?.link?.value"
        [grant]="grant"
      ></ui-body>
    </div>
    <!-- unauthorized --------------------------------------------------------------------------------------------------->

    <!-- authorized ----------------------------------------------------------------------------------------------------->
    <div class="card" *ngIf="(userService.data | async)?.userRole == userRoleEnum.authorized">
      <ui-header
        [status]="grant?.status?.value || 'no_status'"
        [title]="grant?.title?.value"
        [reward]="grant?.reward?.value"
      ></ui-header>
      <ui-body
        [md]="linkContentService.mdText$.getValue()"
        [link]="grant?.link?.value"
        [grant]="grant"
      ></ui-body>
    </div>
    <!-- authorized ----------------------------------------------------------------------------------------------------->

    <!-- DAOMember ------------------------------------------------------------------------------------------------------>
    <div class="card" *ngIf="(userService.data | async)?.userRole == userRoleEnum.DAOMember">
      <ui-header
        [status]="grant?.status?.value || 'no_status'"
        [title]="grant?.title?.value"
        [reward]="grant?.reward?.value"
      ></ui-header>
      <ui-body
        [md]="linkContentService.mdText$.getValue()"
        [link]="grant?.link?.value"
        [grant]="grant"
      ></ui-body>
    </div>
    <!-- DAOMember ------------------------------------------------------------------------------------------------------>

    <!-- workingGroup --------------------------------------------------------------------------------------------------->
    <div class="card" *ngIf="(userService.data | async)?.userRole == userRoleEnum.workingGroup">
      <ui-header
        [status]="grant?.status?.value || 'no_status'"
        [title]="grant?.title?.value"
        [reward]="grant?.reward?.value"
      ></ui-header>
      <ui-body
        [md]="linkContentService.mdText$.getValue()"
        [link]="grant?.link?.value"
        [grant]="grant"
      ></ui-body>
    </div>
    <!-- workingGroup --------------------------------------------------------------------------------------------------->

    <!-- master --------------------------------------------------------------------------------------------------------->
    <div class="card" *ngIf="(userService.data | async)?.userRole == userRoleEnum.master">
      <ui-header
        [status]="grant?.status?.value || 'no_status'"
        [title]="grant?.title?.value"
        [reward]="grant?.reward?.value"
      ></ui-header>
      <ui-body
        [md]="linkContentService.mdText$.getValue()"
        [link]="grant?.link?.value"
        [grant]="grant"
      ></ui-body>
    </div>
    <!-- master --------------------------------------------------------------------------------------------------------->

    <!-- team ----------------------------------------------------------------------------------------------------------->
    <ui-team
      [grant]="grant"
    ></ui-team>
<!--    <div class="card team">-->
<!--      <h4>Teams</h4>-->
<!--      <div class="card__body" *ngIf="grant?.app?.length > 0">-->
<!--        <ul>-->
<!--          <li *ngFor="let app of grant.app">-->
<!--            <ng-container *ngIf="app?.name?.value">-->
<!--              <div class="info">-->
<!--                <div class="name">{{app?.name?.value}}</div>-->
<!--                <div class="id">{{app?.id?.value}}</div>-->
<!--                <div class="link">{{app?.link?.value}}</div>-->
<!--              </div>-->
<!--              <div class="controls">-->
<!--                <div-->
<!--                  *ngIf="app?.voted?.value.includes(userService.data.getValue().userAddress) && userService.data.getValue().userAddress">-->
<!--                  {{'entity.already_voted' | transloco}}-->
<!--                </div>-->
<!--                <div-->
<!--                  *ngIf="-->
<!--                grant?.status?.value === grantStatusEnum.readyToApply &&-->
<!--                userService.data.getValue().roles.isDAO &&-->
<!--                 !(app?.voted?.value.includes(userService.data.getValue().userAddress))-->
<!--              && userService.data.getValue().userAddress-->
<!--              && !userService.data.getValue().userAddress.includes(app?.id?.value)-->
<!--              ">-->
<!--                  &lt;!&ndash;                     // grant?.status?.value === grantStatusEnum.readyToApply &&&ndash;&gt;-->
<!--                  <img (click)="voteTeam( 'dislike', app.id.value)" src="assets/icons/vote-min.svg">-->
<!--                  <img (click)="voteTeam('like', app.id.value)" src="assets/icons/vote-plus.svg">-->
<!--                </div>-->
<!--                <div *ngIf="userService.data.getValue().userAddress.includes(app?.id?.value)">-->
<!--                  {{'entity.this_your_team' | transloco}}-->
<!--                </div>-->
<!--              </div>-->
<!--            </ng-container>-->

<!--          </li>-->
<!--        </ul>-->
<!--      </div>-->
<!--      <div class="card__body" *ngIf="grant?.app?.length === 0">-->
<!--        {{'entity.no_applied_teams' | transloco}}-->
<!--      </div>-->
<!--    </div>-->
    <!-- team ----------------------------------------------------------------------------------------------------------->

    <!-- vote ----------------------------------------------------------------------------------------------------------->
    <!--   *ngIf="(userService.data | async)?.roles.isDAO && !(userService.data | async)?.voted.includes(grant.id)"-->
    <div class="card"
         *ngIf="(userService.data | async)?.roles.isDAO && grant?.status?.value === grantStatusEnum.proposed">
      <div
        class="card__info">
        <div class="card__info__left">
          <img src="assets/icons/vote.svg">
        </div>
        <div class="card__info__mid">
          <ng-container *ngIf="(userService.data | async)?.voted.includes(grant.id)">
            <div class="card__info__mid__subtext">
              {{'entity.DAO.vote.true.subtext' | transloco}}
            </div>
            <div class="card__info__mid__text">
              {{'entity.DAO.vote.true.text' | transloco}}
            </div>
          </ng-container>
          <ng-container *ngIf="!(userService.data | async)?.voted.includes(grant.id)">
            <div class="card__info__mid__subtext">
              {{'entity.DAO.vote.false.text' | transloco}}
            </div>
            <div class="card__info__mid__text">
              {{'entity.DAO.vote.false.text' | transloco}}
            </div>
          </ng-container>
        </div>
        <div class="card__info__right" *ngIf="!(userService.data | async)?.voted.includes(grant.id)">
          <img (click)="vote('dislike')" src="assets/icons/vote-min.svg">
          <img (click)="vote('like')" src="assets/icons/vote-plus.svg">
        </div>
      </div>
    </div>
    <!-- vote ----------------------------------------------------------------------------------------------------------->

    <ui-controls
      [status]="grant?.status?.value"
      [grantId]="grant?.id"
      [role]="userService.data.getValue().userRole"
      [voted]="grant?.voted"
      [performer]="grant?.performer?.value"
    ></ui-controls>

    <ui-modal></ui-modal>
  </div>
  <div class="container__right"></div>
</div>

