<div class="entity">
  <!--  {{(userService.data | async)?.voted.includes(grant.id) ? 'yes' : 'no'}}-->
  <!-- unauthorized --------------------------------------------------------------------------------------------------->
  <div class="card" *ngIf="(userService.data | async)?.userRole == userRoleEnum.unauthorized">
    <div class="card__header">
      <div class="card__header__left-block">
        <div class="card__header__left-block__status">
          {{'listing.status.' + (grant?.status?.value || 'no_status') | transloco}}
        </div>
        <div class="card__header__left-block__title">{{grant?.title?.value}}</div>
      </div>
      <div class="card__header__right-block">
        <div class="card__header__right-block__text">
          {{'entity.reward' | transloco}}
        </div>
        <div class="card__header__right-block__price">
          {{grant?.reward?.value / 100000000 | number : '1.2'}}
          <div class="icon-logo"></div>
        </div>
      </div>
    </div>
    <div class="card__body">
      {{'entity.link' | transloco}}: <a [href]="grant?.link?.value"
                                        *ngIf="grant?.link?.value">{{grant?.link?.value}}</a>
      <span *ngIf="!grant.link">{{'entity.empty_link' | transloco}}</span>
      <pre *ngIf="environment.showDevTools">{{ grant | json }}</pre>
    </div>
  </div>
  <!-- unauthorized --------------------------------------------------------------------------------------------------->

  <!-- authorized ----------------------------------------------------------------------------------------------------->
  <div class="card" *ngIf="(userService.data | async)?.userRole == userRoleEnum.authorized">
    <!--  <div class="card">-->
    <div class="card__header">
      <div class="card__header__left-block">
        <div class="card__header__left-block__status">
          {{'listing.status.' + (grant?.status?.value || 'no_status') | transloco}}
        </div>
        <div class="card__header__left-block__title">{{grant?.title?.value}}</div>
      </div>
      <div class="card__header__right-block">
        <div class="card__header__right-block__text">
          {{'entity.reward' | transloco}}
        </div>
        <div class="card__header__right-block__price">
          {{grant?.reward?.value / 100000000 | number : '1.2'}}
          <div class="icon-logo"></div>
        </div>
      </div>
    </div>
    <div class="card__body">

      link: <a [href]="grant.link" *ngIf="grant.link">LINK</a> <span *ngIf="!grant.link">link empty</span>
      <pre *ngIf="environment.showDevTools">{{ grant | json }}</pre>
    </div>
    <div class="card__info">
      <div class="card__info__left">
        <img src="assets/icons/grant-completed.svg" *ngIf="grant?.status?.value === grantStatusEnum.workFinished">
        <img src="assets/icons/grant-failed.svg" *ngIf="grant?.status?.value === grantStatusEnum.rejected">
        <img src="assets/icons/grant-wait.svg" *ngIf="grant?.status?.value === grantStatusEnum.proposed">
      </div>
      <div class="card__info__mid">
        <ng-container *ngIf="grant?.status?.value === grantStatusEnum.proposed">
          <div class="card__info__mid__subtext">
            {{'entity.grant.status.proposed.subtext' | transloco}}
          </div>
          <div class="card__info__mid__text">
            {{'entity.grant.status.proposed.text' | transloco}}
          </div>
        </ng-container>
        <ng-container *ngIf="grant?.status?.value === grantStatusEnum.rejected">
          <div class="card__info__mid__subtext">
            {{'entity.grant.status.rejected.subtext' | transloco}}
          </div>
          <div class="card__info__mid__text">
            {{'entity.grant.status.rejected.text' | transloco}}
          </div>
        </ng-container>
        <ng-container *ngIf="grant?.status?.value === grantStatusEnum.workFinished">
          <div class="card__info__mid__subtext">
            {{'entity.grant.status.workFinished.subtext' | transloco}}
          </div>
          <div class="card__info__mid__text">
            {{'entity.grant.status.workFinished.text' | transloco}}
          </div>
        </ng-container>
      </div>
    </div>
  </div>
  <!-- authorized ----------------------------------------------------------------------------------------------------->

  <!-- DAOMember ------------------------------------------------------------------------------------------------------>
  <div class="card" *ngIf="(userService.data | async)?.userRole == userRoleEnum.DAOMember">
    <!--  <div class="card">-->

    <div class="card__header">
      <div class="card__header__left-block">
        <div class="card__header__left-block__status">
          {{'listing.status.' + (grant?.status?.value || 'no_status') | transloco}}      {{grant?.id}}
        </div>
        <div class="card__header__left-block__title">{{grant?.title?.value}}</div>
      </div>
      <div class="card__header__right-block">
        <div class="card__header__right-block__text">
          {{'entity.reward' | transloco}}
        </div>
        <div class="card__header__right-block__price">
          {{grant?.reward?.value / 100000000 | number : '1.2'}}
          <div class="icon-logo"></div>
        </div>
      </div>
    </div>
    <div class="card__body">
      link: <a [href]="grant.link" *ngIf="grant.link">LINK</a> <span *ngIf="!grant.link">link empty</span>
      <pre *ngIf="environment.showDevTools">{{ grant | json }}</pre>
    </div>
    <div class="card__info">
      <div class="card__info__left">
        <img src="assets/icons/vote.svg">
      </div>
      <div class="card__info__mid">
        <ng-container *ngIf="!isDAOVote">
          <div class="card__info__mid__subtext">
            {{'entity.DAO.vote.true.subtext' | transloco}}
          </div>
          <div class="card__info__mid__text">
            {{'entity.DAO.vote.true.text' | transloco}}
          </div>
        </ng-container>
        <ng-container *ngIf="isDAOVote">
          <div class="card__info__mid__subtext">
            {{'entity.DAO.vote.false.text' | transloco}}
          </div>
          <div class="card__info__mid__text">
            {{'entity.DAO.vote.false.text' | transloco}}
          </div>
        </ng-container>
      </div>
      <div class="card__info__right" *ngIf="!isDAOVote && !(userService.data | async)?.voted.includes(grant.id)">
        <img (click)="vote(-1)" src="assets/icons/vote-min.svg">
        <img (click)="vote(1)" src="assets/icons/vote-plus.svg">
      </div>
    </div>
  </div>
  <!-- DAOMember ------------------------------------------------------------------------------------------------------>

  <!-- workingGroup --------------------------------------------------------------------------------------------------->
  <div class="card" *ngIf="(userService.data | async)?.userRole == userRoleEnum.workingGroup">
    <!--  <div class="card">-->
    <div class="card__header">
      <div class="card__header__left-block">
        <div class="card__header__left-block__status">
          {{'listing.status.' + (grant?.status?.value || 'no_status') | transloco}}
        </div>
        <div class="card__header__left-block__title">{{grant?.title?.value}}</div>
      </div>
      <div class="card__header__right-block">
        <div class="card__header__right-block__text">
          {{'entity.reward' | transloco}}
        </div>
        <div class="card__header__right-block__price">
          {{grant?.reward?.value / 100000000 | number : '1.2'}}
          <div class="icon-logo"></div>
        </div>
      </div>
    </div>
    <div class="card__body">
      link: <a [href]="grant.link" *ngIf="grant.link">LINK</a> <span *ngIf="!grant.link">link empty</span>
      <pre *ngIf="environment.showDevTools">{{ grant | json }}</pre>

    </div>
    <div *ngIf="(userService.data | async)?.roles.isDAO && !(userService.data | async)?.voted.includes(grant.id)"
         class="card__info">
      <div class="card__info__left">
        <img src="assets/icons/vote.svg">
      </div>
      <div class="card__info__mid">
        <ng-container *ngIf="!isDAOVote">
          <div class="card__info__mid__subtext">
            {{'entity.DAO.vote.true.subtext' | transloco}}
          </div>
          <div class="card__info__mid__text">
            {{'entity.DAO.vote.true.text' | transloco}}
          </div>
        </ng-container>
        <ng-container *ngIf="isDAOVote">
          <div class="card__info__mid__subtext">
            {{'entity.DAO.vote.false.text' | transloco}}
          </div>
          <div class="card__info__mid__text">
            {{'entity.DAO.vote.false.text' | transloco}}
          </div>
        </ng-container>
      </div>
      <div class="card__info__right" *ngIf="!isDAOVote">
        <img (click)="vote(-1)" src="assets/icons/vote-min.svg">
        <img (click)="vote(1)" src="assets/icons/vote-plus.svg">
      </div>
    </div>
  </div>
  <!-- workingGroup --------------------------------------------------------------------------------------------------->

  <!-- master --------------------------------------------------------------------------------------------------------->
  <div class="card" *ngIf="(userService.data | async)?.userRole == userRoleEnum.master">
    <!--  <div class="card">-->
    <div class="card__header">
      <div class="card__header__left-block">
        <div class="card__header__left-block__status">
          {{'listing.status.' + (grant?.status?.value || 'no_status') | transloco}}
        </div>
        <div class="card__header__left-block__title">{{grant?.title?.value}}</div>
      </div>
      <div class="card__header__right-block">
        <div class="card__header__right-block__text">
          {{'entity.reward' | transloco}}
        </div>
        <div class="card__header__right-block__price">
          {{grant?.reward?.value / 100000000 | number : '1.2'}}
          <div class="icon-logo"></div>
        </div>
      </div>
    </div>
    <div class="card__body">
      <div class="btn-container no-padding-right">
        <button class="btn active"> {{'entity.apply' | transloco}}</button>
      </div>
      link: <a [href]="grant.link" *ngIf="grant.link">LINK</a> <span *ngIf="!grant.link">link empty</span>
      <pre *ngIf="environment.showDevTools">{{ grant | json }}</pre>
    </div>
  </div>
  <!-- master --------------------------------------------------------------------------------------------------------->
  <!-- team ----------------------------------------------------------------------------------------------------------->
  <!--  <div class="card team" *ngIf="userService.data.getValue().roles.isDAO">-->
  <div class="card team">
    <h4>Teams</h4>
    <div class="card__body">
      <ul>
        <li *ngFor="let app of grant.app">
          <div class="info">
            <div class="name">{{app?.name?.value}}</div>
            <div class="link">{{app?.link?.value}}</div>
          </div>
          <div class="controls">
            <code>
              userAddress: {{userService.data.getValue().userAddress}}<br>
              grant?.id: {{grant?.id}} <br>
              app?.leader?.value: {{app?.leader?.value}} <br>
              isVoteForTeam: {{ userService.isVoteForTeam(grant?.id, app?.leader?.value) }} <br>
            </code>

            <img (click)="voteTeam(-1, app.id.value)" src="assets/icons/vote-min.svg">
            <img (click)="voteTeam(1, app.id.value)" src="assets/icons/vote-plus.svg">
          </div>
        </li>
      </ul>
    </div>
  </div>
  <!-- team ----------------------------------------------------------------------------------------------------------->
  <!-- controls ------------------------------------------------------------------------------------------------------->
  <div class="card">
    <h4>Controls</h4>
    <div class="card__body">
      <div class="btn-container">
        <button (click)="modal?.openModal()" class="btn" *ngIf="userService.data.getValue().roles.isMaster">
          {{'entity.remove' | transloco}}
        </button>
        <button
          [routerLink]="['/', 'edit-grant', grant.id ]"
          class="btn"
          *ngIf="userService.data.getValue().roles.isMaster">
          {{'entity.edit' | transloco}}
        </button>

        <!--WG-->
        <button
          (click)="finishVote()"
          class="btn" *ngIf="userService.data.getValue().roles.isWG">
          {{'entity.finish_vote' | transloco}}
        </button>
        <button
          (click)="modal?.openModal()"
          class="btn" *ngIf="userService.data.getValue().roles.isWG">
          {{'entity.remove' | transloco}}
        </button>
        <button
          [routerLink]="['/', 'edit-grant', grant.id ]"
          class="btn"
          *ngIf="userService.data.getValue().roles.isWG">
          {{'entity.edit' | transloco}}
        </button>

        <!--unauthorized-->
        <button
          class="btn active"
          [routerLink]="['/', 'apply-grant', grant.id]"
          *ngIf="userService.data.getValue().userRole !== userRoleEnum.unauthorized"
          [disabled]="userService.data.getValue().apply.includes(grant?.id)">
          {{'entity.apply' | transloco}}
        </button>
        <button
          class="btn active"
          (click)="signup()"
          *ngIf="userService.data.getValue().userRole == userRoleEnum.unauthorized">
          {{'entity.log_in_for_apply' | transloco}}
        </button>
      </div>
    </div>
  </div>
  <!-- controls ------------------------------------------------------------------------------------------------------->

  <ui-modal></ui-modal>
</div>
